<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>HV TITAN MP4 | Hayra Vesile Enterprise</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;300;400;500;600;700;800&family=JetBrains+Mono:wght@800&display=swap');

        :root {
            --hv-emerald: #10b981;
            --hv-bg: #000000;
            --hv-card: #0a0a0b;
            --hv-border: #1a1a1c;
            --hv-glow: 0 0 20px rgba(16, 185, 129, 0.3);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Plus Jakarta Sans', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--hv-bg); color: white; overflow-x: hidden; scroll-behavior: smooth; }

        /* --- HV SPLASH ENGINE --- */
        #splash {
            position: fixed; inset: 0; background: var(--hv-bg); z-index: 100000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .hv-loader-logo {
            font-size: 80px; font-weight: 900; background: var(--hv-emerald); color: black;
            width: 140px; height: 140px; display: flex; align-items: center; justify-content: center;
            border-radius: 40px; box-shadow: var(--hv-glow); animation: hvPulse 2s infinite;
        }
        @keyframes hvPulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.1); opacity: 0.8; } }

        /* --- NAVIGATION --- */
        .hv-nav-top {
            position: sticky; top: 0; z-index: 5000; padding: 15px 20px;
            background: rgba(0,0,0,0.85); backdrop-filter: blur(30px);
            border-bottom: 1px solid var(--hv-border);
        }
        .hv-logo-text { font-family: 'JetBrains Mono', monospace; color: var(--hv-emerald); font-size: 26px; font-weight: 800; display: flex; align-items: center; gap: 8px; }
        .hv-logo-text span { background: var(--hv-emerald); color: black; padding: 0 8px; border-radius: 6px; }

        /* --- POST CARDS (VIDEO SPECIAL) --- */
        .post-card {
            background: var(--hv-card); border: 1px solid var(--hv-border);
            border-radius: 35px; margin: 25px auto; max-width: 500px; overflow: hidden;
            transition: 0.3s;
        }
        .video-wrapper {
            position: relative; width: 100%; aspect-ratio: 9/16; background: #000;
            max-height: 700px; display: flex; align-items: center; justify-content: center;
        }
        video { width: 100%; height: 100%; object-fit: cover; }

        .video-overlay {
            position: absolute; bottom: 0; left: 0; right: 0; padding: 30px 20px;
            background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
        }

        /* --- BUTTONS --- */
        .hv-btn-main {
            background: var(--hv-emerald); color: black; padding: 12px 24px;
            border-radius: 18px; font-weight: 800; transition: 0.3s;
        }
        .hv-btn-main:hover { transform: scale(1.05); box-shadow: var(--hv-glow); }

        /* --- FLOATING TAB BAR --- */
        .hv-tab-bar {
            position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 450px; background: rgba(15,15,17,0.95);
            backdrop-filter: blur(20px); border: 1px solid var(--hv-border);
            border-radius: 40px; padding: 15px 30px; display: flex;
            justify-content: space-around; align-items: center; z-index: 9999;
        }
        .tab-icon { font-size: 24px; color: #444; cursor: pointer; transition: 0.3s; }
        .tab-icon.active { color: var(--hv-emerald); filter: drop-shadow(0 0 8px var(--hv-emerald)); }

        .add-btn-circle {
            width: 70px; height: 70px; background: var(--hv-emerald); color: black;
            border-radius: 25px; display: flex; align-items: center; justify-content: center;
            font-size: 32px; transform: translateY(-40px); border: 8px solid var(--hv-bg);
            box-shadow: 0 15px 30px rgba(16, 185, 129, 0.4);
        }

        /* --- UPLOAD MODAL --- */
        #upload-modal {
            position: fixed; inset: 0; background: rgba(0,0,0,0.98);
            z-index: 10000; display: none; flex-direction: column;
        }
        .drop-zone {
            width: 100%; height: 350px; border: 4px dashed var(--hv-border);
            border-radius: 40px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; transition: 0.3s;
        }
        .drop-zone.active { border-color: var(--hv-emerald); background: rgba(16, 185, 129, 0.05); }

        /* --- SCROLLBAR --- */
        ::-webkit-scrollbar { width: 0; }
    </style>
</head>
<body>

    <div id="splash">
        <div class="hv-loader-logo">HV</div>
        <p class="mt-6 font-black tracking-[0.3em] text-emerald-500">TITAN MP4 ENGINE</p>
    </div>

    <nav class="hv-nav-top">
        <div class="max-w-[1200px] mx-auto flex justify-between items-center">
            <div class="hv-logo-text"><span>HV</span> HAYRA VESİLE</div>
            <div class="flex gap-5 items-center">
                <i class="fa-solid fa-shield-halved text-emerald-500 text-xl"></i>
                <div id="u-avatar-top" class="w-10 h-10 rounded-xl overflow-hidden border border-white/10" onclick="showView('profile')"></div>
            </div>
        </div>
    </nav>

    <main class="max-w-[600px] mx-auto pb-40">
        <div id="feed-view" class="px-2"></div>
        
        <div id="profile-view" class="hidden pt-10 px-6 text-center">
            <div class="w-32 h-32 mx-auto bg-emerald-500 rounded-[45px] p-1 mb-6">
                <img id="p-img-big" class="w-full h-full object-cover rounded-[40px] border-4 border-black">
            </div>
            <h2 id="p-name" class="text-3xl font-black mb-10 tracking-tighter">...</h2>
            <div class="grid grid-cols-2 gap-2" id="my-videos-grid"></div>
        </div>
    </main>

    <div id="upload-modal">
        <div class="p-6 flex justify-between items-center border-b border-white/5">
            <button onclick="closeUpload()" class="text-zinc-500 font-bold">İptal</button>
            <span class="font-black text-emerald-500">SADECE MP4 PAYLAŞIMI</span>
            <button onclick="handlePublish()" id="pub-btn" class="hv-btn-main !py-2 !px-6">PAYLAŞ</button>
        </div>
        <div class="p-8 space-y-8 max-w-lg mx-auto w-full">
            <div class="drop-zone" onclick="document.getElementById('video-in').click()" id="drop-zone">
                <i class="fa-solid fa-clapperboard text-6xl text-emerald-500 mb-4"></i>
                <p id="file-status" class="font-bold opacity-30">MP4 VİDEO SEÇİN</p>
                <input type="file" id="video-in" class="hidden" accept="video/mp4" onchange="checkFile(this)">
            </div>
            <textarea id="caption-in" class="w-full bg-transparent text-2xl font-bold outline-none h-32 border-b border-white/10" placeholder="Videona bir açıklama ekle..."></textarea>
            <div class="p-4 bg-emerald-500/10 rounded-2xl border border-emerald-500/20">
                <p class="text-[10px] font-black text-emerald-500 uppercase tracking-widest leading-tight">
                    <i class="fa-solid fa-circle-info mr-2"></i> Güvenlik Kuralı: Fotoğraf yüklemesi devre dışı bırakılmıştır. Sadece .mp4 uzantılı dosyalar kabul edilir.
                </p>
            </div>
        </div>
    </div>

    <nav class="hv-tab-bar">
        <i class="fa-solid fa-house tab-icon active" onclick="showView('feed')"></i>
        <div class="add-btn-circle" onclick="openUpload()">
            <i class="fa-solid fa-video"></i>
        </div>
        <i class="fa-solid fa-user tab-icon" onclick="showView('profile')"></i>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp, doc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDZO3lct-xzXAx79lbqgMP7s6WRCirWIHk",
            authDomain: "hayravesile.firebaseapp.com",
            projectId: "hayravesile",
            storageBucket: "hayravesile.appspot.com",
            messagingSenderId: "980073667334",
            appId: "1:980073667334:web:1f6260f0abf3bcc820dc87"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        let user = null;

        onAuthStateChanged(auth, u => {
            if(u) {
                user = u;
                document.getElementById('splash').style.transform = 'scale(1.5)';
                document.getElementById('splash').style.opacity = '0';
                setTimeout(() => document.getElementById('splash').style.display = 'none', 800);
                
                document.getElementById('u-avatar-top').innerHTML = `<img src="${u.photoURL}" class="w-full h-full object-cover">`;
                document.getElementById('p-img-big').src = u.photoURL;
                document.getElementById('p-name').innerText = u.displayName;
                startEngine();
            } else { signInWithPopup(auth, new GoogleAuthProvider()); }
        });

        window.showView = (v) => {
            document.getElementById('feed-view').classList.add('hidden');
            document.getElementById('profile-view').classList.add('hidden');
            document.getElementById(v + '-view').classList.remove('hidden');
            window.scrollTo({top:0, behavior:'smooth'});
        };

        window.openUpload = () => document.getElementById('upload-modal').style.display = 'flex';
        window.closeUpload = () => document.getElementById('upload-modal').style.display = 'none';

        window.checkFile = (input) => {
            const file = input.files[0];
            if(!file) return;
            if(file.type !== 'video/mp4') {
                Swal.fire('Hata', 'Sadece MP4 videolarına izin veriliyor!', 'error');
                input.value = '';
                return;
            }
            document.getElementById('file-status').innerText = "VİDEO HAZIR: " + file.name.slice(0,15);
            document.getElementById('drop-zone').classList.add('active');
        };

        window.handlePublish = async () => {
            const file = document.getElementById('video-in').files[0];
            const cap = document.getElementById('caption-in').value;
            if(!file || !cap) return Swal.fire('Uyarı', 'Video ve açıklama zorunludur!', 'warning');

            document.getElementById('pub-btn').innerText = "...";
            const sRef = ref(storage, `videos/${Date.now()}_${file.name}`);
            const snap = await uploadBytes(sRef, file);
            const url = await getDownloadURL(snap.ref);

            await addDoc(collection(db, "posts"), {
                url, caption: cap, user: user.displayName, avatar: user.photoURL, uid: user.uid,
                likes: [], date: serverTimestamp(), type: 'video'
            });

            closeUpload();
            confetti({ particleCount: 200, spread: 70, origin: { y: 0.8 }, colors: ['#10b981'] });
            location.reload();
        };

        function startEngine() {
            onSnapshot(query(collection(db, "posts"), orderBy("date", "desc")), snap => {
                const feed = document.getElementById('feed-view');
                const grid = document.getElementById('my-videos-grid');
                feed.innerHTML = ''; grid.innerHTML = '';

                snap.forEach(docSnap => {
                    const p = docSnap.data();
                    const pid = docSnap.id;
                    const isLiked = p.likes?.includes(user.uid);

                    const card = `
                        <div class="post-card">
                            <div class="p-5 flex items-center gap-3">
                                <img src="${p.avatar}" class="w-10 h-10 rounded-full border border-emerald-500">
                                <span class="font-black text-sm uppercase tracking-tighter">${p.user}</span>
                            </div>
                            <div class="video-wrapper" ondblclick="like('${pid}', ${JSON.stringify(p.likes)})">
                                <video src="${p.url}" loop muted playsinline onmouseover="this.play()" onmouseout="this.pause()"></video>
                                <div class="video-overlay">
                                    <div class="flex justify-between items-center mb-4">
                                        <div class="flex gap-6">
                                            <i class="fa-solid fa-heart text-2xl cursor-pointer ${isLiked ? 'text-red-500' : 'text-white'}" onclick="like('${pid}', ${JSON.stringify(p.likes)})"></i>
                                            <i class="fa-solid fa-comment text-2xl text-white"></i>
                                            <i class="fa-solid fa-paper-plane text-2xl text-white"></i>
                                        </div>
                                        <i class="fa-solid fa-bookmark text-2xl text-white"></i>
                                    </div>
                                    <p class="font-black text-emerald-500 mb-1">${p.likes?.length || 0} BEĞENİ</p>
                                    <p class="text-sm font-medium"><span class="font-black mr-2">${p.user}</span>${p.caption}</p>
                                </div>
                            </div>
                        </div>`;
                    
                    feed.innerHTML += card;
                    if(p.uid === user.uid) {
                        grid.innerHTML += `<div class="aspect-[9/16] rounded-2xl overflow-hidden border border-white/5"><video src="${p.url}" class="w-full h-full object-cover"></video></div>`;
                    }
                });
            });
        }

        window.like = async (id, likes) => {
            const r = doc(db, "posts", id);
            if(likes.includes(user.uid)) {
                await updateDoc(r, { likes: arrayRemove(user.uid) });
            } else {
                await updateDoc(r, { likes: arrayUnion(user.uid) });
            }
        };

    </script>
</body>
</html>
